# Template file for 'vscodium'
pkgname=vscodium
version=1.105.17017
revision=1
only_for_archs="x86_64"
hostmakedepends="tar xz"
makedepends=""
depends=""
short_desc="Free/Libre Open Source Software Binaries of VSCode"
maintainer="Naz <ndpm13@ch-naeseem.com>"
license="MIT"
homepage="https://vscodium.com/"
distfiles="https://github.com/VSCodium/vscodium/releases/download/${version}/codium_${version}_amd64.deb"
checksum=aa1d2208d01a1fd76ece11c283d72f4f8c10b3432fe3b1d2aa3af9d2cbec69f4
nostrip=yes

do_extract() {
  mkdir -p ${DESTDIR}
  ar x ${XBPS_SRCDISTDIR}/${pkgname}-${version}/codium_${version}_amd64.deb
  tar xf data.tar.xz -C ${DESTDIR}
}

do_install() {
	vcopy ${DESTDIR}/usr/share/codium /usr/lib/
	vcopy ${DESTDIR}/usr/share/zsh/vendor-completions /usr/share/zsh/site-functions

	vmkdir usr/bin
  ln -sf /usr/lib/codium/bin/codium ${DESTDIR}/usr/bin/codium

	sed -i 's|/usr/share/codium|/usr/lib/codium|g' \
		${DESTDIR}/usr/lib/codium/bin/codium \
		${DESTDIR}/usr/share/applications/codium.desktop \
		${DESTDIR}/usr/share/applications/codium-url-handler.desktop

  rm -rf ${DESTDIR}/usr/share/codium
	rm -rf ${DESTDIR}/usr/share/zsh/vendor-completions
}
