# Template file for 'ly'
pkgname=ly
version=1.3.2
revision=1
archs="x86_64"
hostmakedepends="pkg-config zig-0.15.2"
makedepends="pam-devel libxcb-devel"
depends="xorg-server xauth brightnessctl"
short_desc="A lightweight TUI (ncurses-like) display manager for Linux and BSD."
maintainer="Naz <ndpm13@ch-naseem.com>"
license="WTFPL"
homepage="https://codeberg.org/fairyglade/ly"
distfiles="https://codeberg.org/fairyglade/ly/archive/v${version}.tar.gz"
checksum=db069cc2dcacc64b2890552a10ec8547aee4f9b9e5b0bc6b07c3d5d431a757e6
conf_files="
/etc/ly/config.ini
/etc/pam.d/ly
/etc/pam.d/ly-autologin"
nopie=yes

do_build() {
	zig build installexe -Dinit_system=runit
}

do_install() {
	vbin zig-out/bin/ly

	vsv ly
	
	vmkdir etc/sv/ly
	vinstall res/config.ini 644 etc/ly

	vinstall res/pam.d/ly-linux 644 etc/pam.d ly
	vinstall res/pam.d/ly-linux-autologin 644 etc/pam.d ly-autologin

	vinstall res/setup.sh 755 etc/ly

	vcopy res/lang etc/ly
	vcopy res/custom-sessions etc/ly
}

post_install() {
	vlicense license.md
}